<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />

    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    @* --- STYLES --- *@
    <link href="css/app.css" rel="stylesheet" />
    <link href="css/site.css" rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    @* --- PRISM THEMES --- *@
    @* Use absolute paths (/) to prevent 404s on article pages *@
    <link rel="preload" href="css/prism-dark.css" as="style">
    <link rel="preload" href="css/prism-light.css" as="style">

    @* Default Link *@
    <link id="prism-theme-link" rel="stylesheet" href="css/prism-dark.css">

    @* --- BOOT SCRIPT --- *@
    <script>
        (function () {
            // Check System Preference
            var systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

            // Check Saved Preference
            var savedTheme = localStorage.getItem('user-theme');

            // Resolve effective mode
            var mode = 'dark';

            if (savedTheme === 'light') mode = 'light';
            else if (savedTheme === 'dark') mode = 'dark';
            else mode = systemDark ? 'dark' : 'light'; // Default to System

            // Apply Variables
            document.documentElement.setAttribute('data-theme', mode);

            // Apply Codebox Theme
            if (mode === 'light') {
                document.getElementById('prism-theme-link').href = "css/prism-light.css";
            }
        })();
    </script>

    @* Core Prism *@
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" data-manual></script>

    @* Languages *@
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-nasm.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-powershell.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-kotlin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-gdscript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>

    <HeadOutlet />
</head>

<body class="min-h-screen bg-bg-base font-sans text-text-dim antialiased selection:bg-accent selection:text-white">
    <Routes />

    @* --- CUSTOM SCRIPTS --- *@
    <script src="js/site.js"></script>
</body>

</html>